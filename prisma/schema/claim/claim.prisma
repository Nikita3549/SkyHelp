model Claim {
  id                 String               @id @default(cuid()) @map("id")
  step               Int                  @default(5)
  formState          String?              @default("") @map("form_state")
  userId             String?              @map("user_id")
  user               User?                @relation("UserClaims", fields: [userId], references: [id], onDelete: Cascade)
  agentId            String?              @map("agent_id")
  agent              User?                @relation("AgentClaims", fields: [agentId], references: [id], onDelete: Cascade)
  assignedAt         DateTime             @default(now()) @map("assigned_at")
  detailsId          String               @map("details_id")
  details            ClaimDetails         @relation(fields: [detailsId], references: [id], onDelete: Cascade)
  stateId            String               @map("state_id")
  state              ClaimState           @relation(fields: [stateId], references: [id], onDelete: Cascade)
  flightStatuses     ClaimFlightStatus[]
  customerId         String               @map("customer_id")
  customer           ClaimCustomer        @relation(fields: [customerId], references: [id], onDelete: Cascade)
  issueId            String               @map("issue_id")
  issue              ClaimIssue           @relation(fields: [issueId], references: [id], onDelete: Cascade)
  envelopeId         String?              @map("envelope_id")
  archived           Boolean              @default(false)
  continueLink       String?              @map("continue_link")
  documents          Document[]
  passengers         OtherPassenger[]
  paymentId          String?              @map("payment_id")
  payment            ClaimPayment?        @relation(fields: [paymentId], references: [id], onDelete: Cascade)
  createdAt          DateTime             @default(now()) @map("created_at")
  updatedAt          DateTime             @updatedAt @map("updated_at")
  recentUpdatedAt    DateTime             @default(now()) @map("recent_updated_at")
  recentUpdates      ClaimRecentUpdates[]
  documentRequests   DocumentRequest[]
  email              Email[]
  emailResumeClick   EmailResumeClick[]
  activities         ClaimActivity[]
  referrer           String?
  referrerSource     String?              @map("referrer_source")
  referalTransaction ReferralTransaction?

  duplicates    DuplicatedClaim[] @relation("ClaimOriginal")
  duplicatedOf  DuplicatedClaim[] @relation("ClaimDuplicate")
  referredById  String?           @map("referred_by_id")
  referredBy    Partner?          @relation("Referrals", fields: [referredById], references: [id])
  stafMessages  StaffMessage[]
  meteoStatuses MeteoStatus[]

  @@index([agentId])
  @@index([agentId, createdAt])
  @@index([archived])
  @@index([userId])
  @@map("claims")
}
