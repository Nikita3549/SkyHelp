ENGLISH/RUSSIAN

------------ ENGLISH ------------

There are three different workflows handled by a single route: POST /v1/zoho/link –
This route returns a link that should be embedded in an iframe, where the user can sign the agreement.

The request body must include the following fields:

{
    @IsString()
    claimId: string;

    @IsEnum(SignScenarioType)
    scenario: SignScenarioType;
}

claimId – the ID of the claim

scenario – one of the possible workflow types: "MainFlow" | "ExternalFlow" | "OtherPassenger"

1. MainFlow
This scenario occurs when the user requests the signing link from step 7 of the claim form.
The link will be embedded in an iframe.

For this case, the request body must include a third field:

jwt: string – a token related to the form. On the frontend, it can be obtained using the useClaimJwt hook via the getClaimJwt method.

2. ExternalFlow
This scenario occurs when an admin copies a signing link for a separate signature flow.
It is used on the page: https://skyhelp.md/sign/customer

For this case, the request body must include a third field:

customerId: string – the ID of the customer entity. On the frontend, it can be retrieved from the query parameters.

3. OtherPassenger Flow
This scenario is for signing by an additional passenger.
It is used on the page: https://skyhelp.md/sign

For this case, the request body must include a third field:

passengerId: string – the ID of the additional passenger entity. On the frontend, it can be retrieved from the query parameters.

------------ RUSSIAN ------------

Есть три разных workflows, которые реализуются в одном роуте POST /v1/zoho/link -
он возвращает ссылку, которую надо вставить в iframe, где пользователь уже подпишет соглашение.

Для каждого сценария есть необходимый поля, который надо положить в body
{
    @IsString()
    claimId: string;

    @IsEnum(SignScenarioType)
    scenario: SignScenarioType;
}
claimId - id заявки
scenario - один из вариантов workflow. Принимает: "MainFlow" | "ExternalFlow" | "OtherPassenger"

1. MainFlow - сценарий, где пользователь с 7 этапа формы запрашивает ссылку и она вставляется в iframe.

Для этой ситуации в body надо добавить третье поле

jwt: string - это токен формы, на фронте его можно получить в useClaimJwt -> getClaimJwt

2. ExternalFlow - сценарий, в котором админ скопировал ссылку для отдельной подписи.
Ситуация реализуется на страничке: https://skyhelp.md/sign/customer

Для этой ситуации в body надо добавить третье поле

customerId - id сущности клиента. На фронте его можно получить из параметров запроса

3. OtherPassenger flow - сценарий, для подписи доп пассажира.
Ситуация реализуется на страничке: https://skyhelp.md/sign

Для этой ситуации в body надо добавить третье поле

passengerId - id сущности доп пассажира. На фронте его можно получить из параметров запроса.